{"version":3,"file":"PRIVATE_useCollectionFocusRing.js","sources":["../../../src/hooks/PRIVATE_useCollectionFocusRing/useCollectionFocusRing.ts","../../../src/hooks/PRIVATE_useCollectionFocusRing/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nimport { useCallback, useState, useRef } from 'preact/hooks';\n\n/**\n * Hook for handling focus ring management in Collection components.\n *\n * @param contains function that returns true if the Collection contains the specified element.\n * @param navigationKeys set of keys that are considered as navigation keys for Collection.\n * @returns\n */\nexport function useCollectionFocusRing(\n  contains: (elem: Element | null) => boolean,\n  navigationKeys: string[]\n): [\n  boolean,\n  {\n    onFocus: (event: FocusEvent) => void;\n    onBlur: (event: FocusEvent) => void;\n    onKeyDown: (event: KeyboardEvent) => void;\n    onPointerDown: (event: PointerEvent) => void;\n  }\n] {\n  const [focusRingVisible, setFocusRingVisible] = useState(false);\n  const recentPointer = useRef(false);\n\n  const onFocus = useCallback(\n    (event: FocusEvent) => {\n      if (event.relatedTarget == null || !contains(event.relatedTarget as Element)) {\n        if (!focusRingVisible && recentPointer.current === false) {\n          setFocusRingVisible(true);\n        }\n      }\n    },\n    [focusRingVisible]\n  );\n\n  const onBlur = useCallback(\n    (event: FocusEvent) => {\n      setTimeout(() => {\n        if (\n          (event.relatedTarget == null || !contains(document.activeElement)) &&\n          focusRingVisible\n        ) {\n          // remove focus ring\n          setFocusRingVisible(false);\n        }\n      }, FOCUS_SHIFT_TIMEOUT);\n    },\n    [focusRingVisible]\n  );\n\n  const onPointerDown = useCallback(() => {\n    if (focusRingVisible) {\n      setFocusRingVisible(false);\n    }\n    recentPointer.current = true;\n    setTimeout(() => {\n      recentPointer.current = false;\n    }, FOCUS_SHIFT_TIMEOUT);\n  }, [focusRingVisible]);\n\n  const onKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (navigationKeys.indexOf(event.key) > -1) {\n        if (!focusRingVisible) {\n          setFocusRingVisible(true);\n        }\n      }\n    },\n    [focusRingVisible]\n  );\n\n  const focusRingProps = { onFocus, onBlur, onPointerDown, onKeyDown };\n  return [focusRingVisible, focusRingProps];\n}\n\nconst FOCUS_SHIFT_TIMEOUT = 100;\n","/**\n * @license\n * Copyright (c) %FIRST_YEAR% %CURRENT_YEAR%, Oracle and/or its affiliates.\n * The Universal Permissive License (UPL), Version 1.0\n * as shown at https://oss.oracle.com/licenses/upl/\n * @ignore\n */\nexport { useCollectionFocusRing } from './useCollectionFocusRing';\n"],"names":["useState","useRef","useCallback"],"mappings":";;;;;;;AAAA;;;;;;AAMG;AAGH;;;;;;AAMG;AACa,SAAA,sBAAsB,CACpC,QAA2C,EAC3C,cAAwB,EAAA;IAUxB,MAAM,CAAC,gBAAgB,EAAE,mBAAmB,CAAC,GAAGA,cAAQ,CAAC,KAAK,CAAC,CAAC;AAChE,IAAA,MAAM,aAAa,GAAGC,YAAM,CAAC,KAAK,CAAC,CAAC;AAEpC,IAAA,MAAM,OAAO,GAAGC,iBAAW,CACzB,CAAC,KAAiB,KAAI;AACpB,QAAA,IAAI,KAAK,CAAC,aAAa,IAAI,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,aAAwB,CAAC,EAAE;YAC5E,IAAI,CAAC,gBAAgB,IAAI,aAAa,CAAC,OAAO,KAAK,KAAK,EAAE;gBACxD,mBAAmB,CAAC,IAAI,CAAC,CAAC;AAC3B,aAAA;AACF,SAAA;AACH,KAAC,EACD,CAAC,gBAAgB,CAAC,CACnB,CAAC;AAEF,IAAA,MAAM,MAAM,GAAGA,iBAAW,CACxB,CAAC,KAAiB,KAAI;QACpB,UAAU,CAAC,MAAK;AACd,YAAA,IACE,CAAC,KAAK,CAAC,aAAa,IAAI,IAAI,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC;AACjE,gBAAA,gBAAgB,EAChB;;gBAEA,mBAAmB,CAAC,KAAK,CAAC,CAAC;AAC5B,aAAA;SACF,EAAE,mBAAmB,CAAC,CAAC;AAC1B,KAAC,EACD,CAAC,gBAAgB,CAAC,CACnB,CAAC;AAEF,IAAA,MAAM,aAAa,GAAGA,iBAAW,CAAC,MAAK;AACrC,QAAA,IAAI,gBAAgB,EAAE;YACpB,mBAAmB,CAAC,KAAK,CAAC,CAAC;AAC5B,SAAA;AACD,QAAA,aAAa,CAAC,OAAO,GAAG,IAAI,CAAC;QAC7B,UAAU,CAAC,MAAK;AACd,YAAA,aAAa,CAAC,OAAO,GAAG,KAAK,CAAC;SAC/B,EAAE,mBAAmB,CAAC,CAAC;AAC1B,KAAC,EAAE,CAAC,gBAAgB,CAAC,CAAC,CAAC;AAEvB,IAAA,MAAM,SAAS,GAAGA,iBAAW,CAC3B,CAAC,KAAoB,KAAI;QACvB,IAAI,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;YAC1C,IAAI,CAAC,gBAAgB,EAAE;gBACrB,mBAAmB,CAAC,IAAI,CAAC,CAAC;AAC3B,aAAA;AACF,SAAA;AACH,KAAC,EACD,CAAC,gBAAgB,CAAC,CACnB,CAAC;IAEF,MAAM,cAAc,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,CAAC;AACrE,IAAA,OAAO,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC;AAC5C,CAAC;AAED,MAAM,mBAAmB,GAAG,GAAG;;AClF/B;;;;;;AAMG;;;;;;;"}